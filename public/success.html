<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thank You — Party in Pink 4.0</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <main class="wrap narrow">
    <h1>Payment Received</h1>
    <p id="msg">Verifying your payment…</p>
    <a id="dl" class="btn" style="display:none" href="#">Download Ticket (PDF)</a>
  </main>
<script>
function qp(k){ return new URLSearchParams(location.search).get(k) }
const orderId = qp('order_id');
(async function(){
  const r = await fetch(`/api/order-status?order_id=${encodeURIComponent(orderId)}`);
  const j = await r.json();
  if(j.status === 'PAID'){
    document.getElementById('msg').textContent = 'Success! You can download your ticket below.'
    const dl = document.getElementById('dl');
    dl.href = `/api/ticket?order_id=${encodeURIComponent(orderId)}`;
    dl.style.display = 'inline-block';
  } else {
    document.getElementById('msg').textContent = 'Payment not confirmed yet. Please refresh in a minute.'
  }
})();
</script>
</body>
</html>
